name: Static analysis

on:
  push:

jobs:

  phpstan-v1:
    name: PHPStan with composer v1
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2

    - name: Setup PHP
      uses: shivammathur/setup-php@v2
      with:
        php-version: 7.2
        coverage: none

    - run: |
        composer install        

    - run: |
        vendor/bin/phpstan analyze -c phpstan.neon.dist

  phpstan-v2:
    name: PHPStan with composer v2
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2

    - name: Setup PHP
      uses: shivammathur/setup-php@v2
      with:
        php-version: 7.2
        coverage: none
        tools: composer:v2

    - run: |
        composer install        

    - run: |
        vendor/bin/phpstan analyze -c phpstan.neon.dist
